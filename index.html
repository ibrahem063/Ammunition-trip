<!DOCTYPE html>
<html class="dark" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Ammunition Exhibition Journey Map</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<style>
    html, body { width: 100%; height: 100%; margin: 0; }
    main { min-height: 100vh; width: 100vw; }
    body { background-color: #221f10; min-height: 100vh; direction: rtl; overflow-x: hidden; font-family: 'Cairo', sans-serif; }
    
    .parchment-bg {
        background-image: radial-gradient(circle at center, rgba(34,31,16,0.4) 0%, rgba(34,31,16,0.9) 100%), 
                          url('https://www.transparenttextures.com/patterns/papyrus-dark.png');
        position: fixed; inset: 0; z-index: -1; filter: contrast(1.1) sepia(0.3);
    }
    .blueprint-overlay {
        position: fixed; inset: 0; opacity: 0.07; pointer-events: none; z-index: -1;
        background-image: url('https://as1.ftcdn.net/v2/jpg/00/90/08/08/1000_F_90080849_C5UPAYmLWchzQPLwSTcQ1jfE0P2OVfJX.jpg');
        background-size: cover;
    }
    .ornate-border {
        border: 12px double #f2d00d;
        position: fixed; inset: 15px; pointer-events: none; z-index: 100;
        box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
    }

    /* الخط في الخلف */
    #journey-svg {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; z-index: 0; overflow: visible;
    }

    /* الدبوس فوق كل شيء */
    #pin-svg {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; z-index: 200; overflow: visible;
    }

    #journey-path {
        stroke: #b47500;
        stroke-width: 5;
        fill: none;
        stroke-dasharray: 12, 12;
        stroke-linecap: round;
        filter: drop-shadow(0 0 10px rgba(242, 208, 13, 0.8));
        animation: dash-move 20s linear infinite;
    }

    #map-pin {
        fill: #f2d00d;
        stroke: #fff;
        stroke-width: 3;
        transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
        filter: drop-shadow(0 0 15px #f2d00d);
    }

    @keyframes dash-move {
        from { stroke-dashoffset: 240; }
        to { stroke-dashoffset: 0; }
    }

    .start-point {
        background: #f2d00d; color: #221f10;
        padding: 10px 20px; border-radius: 50px;
        font-weight: bold; box-shadow: 0 0 20px #f2d00d;
    }
    
    .node-up { transform: translateY(-120px); }
    .node-down { transform: translateY(120px); }

    @media (max-width: 1024px) {
      .node-up { transform: translateX(-70px); }
      .node-down { transform: translateX(70px); }
    }

    /* انيميشن الانفجار والموجة */
    .key-burst {
        position: absolute; inset: 0; border-radius: inherit;
        background: radial-gradient(circle, rgba(242,208,13,0.9) 0%, rgba(242,208,13,0.4) 40%, transparent 20%);
        animation: burstAnim 0.6s ease-out forwards;
        pointer-events: none;
    }
    @keyframes burstAnim { 0% { transform: scale(0.3); opacity: 1; } 100% { transform: scale(2); opacity: 0; } }
    .key-collected { animation: collectAnim 0.5s ease forwards; }
    @keyframes collectAnim { 0% { transform: scale(1); filter: brightness(1); } 50% { transform: scale(1.2); filter: brightness(1.6); } 100% { transform: scale(0); opacity: 0; } }
    .energy-wave {
        position: absolute; inset: 0; border-radius: inherit;
        border: 10px solid #f2d00d;
        animation: waveAnim 1.2s ease-out forwards;
        pointer-events: none;
    }
    @keyframes waveAnim { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(2.2); opacity: 0; } }
</style>
</head>
<body class="text-white">

<div class="parchment-bg"></div>
<div class="blueprint-overlay"></div>
<div class="ornate-border"></div>

<header class="relative z-[110] p-8 flex flex-col md:flex-row justify-between items-center gap-6">
    <div class="bg-black/60 backdrop-blur-md p-4 rounded-lg border-r-4 border-[#f2d00d]">
        <h2 class="text-[#f2d00d] text-2xl font-bold">رحلة داخل معرض الذخيرة</h2>
        <p class="text-white/70 text-sm italic">اجمع المفاتيح لفتح كنز المعرفة</p>
    </div>
    <div class="bg-black/40 backdrop-blur-md p-3 rounded-xl border border-[#f2d00d]/30 flex items-center gap-6">
        <div class="flex flex-col items-center">
            <span class="text-[#f2d00d] text-[10px] font-bold">المفاتيح المجمعة</span>
            <div id="key-indicators" class="flex gap-2 mt-1">
                <span class="material-icons text-white/10 text-xl">vpn_key</span>
                <span class="material-icons text-white/10 text-xl">vpn_key</span>
                <span class="material-icons text-white/10 text-xl">vpn_key</span>
                <span class="material-icons text-white/10 text-xl">vpn_key</span>
            </div>
        </div>
        <div class="h-10 w-[1px] bg-[#f2d00d]/20"></div>
        <div class="text-center">
            <span class="text-[#f2d00d] text-[10px] block">الإنجاز</span>
            <span id="progress-text" class="text-2xl font-bold text-[#f2d00d]">0%</span>
        </div>
    </div>
</header>

<main class="relative z-10 max-w-7xl mx-auto px-10 py-20">
    <div id="nodes-container" class="relative flex flex-col lg:flex-row justify-between items-center gap-24 lg:gap-12 min-h-[60vh]">
        
        <svg id="journey-svg">
            <path id="journey-path" d=""></path>
        </svg>

        <svg id="pin-svg">
            <circle id="map-pin" r="12" cx="-50" cy="-50"></circle>
        </svg>
        
        <div class="node relative z-10 flex flex-col items-center">
            <div class="start-point animate-pulse">انطلق من هنا</div>
        </div>

        <div class="node node-up relative z-10 flex flex-col items-center group">
            <div class="w-28 h-28 md:w-36 md:h-36 rounded-full border-4 border-[#f2d00d] overflow-hidden glow-node bg-black relative" onclick="collectKey(0, this)">
                <img src="https://helios-i.mashable.com/imagery/articles/00ucsbs4eF1goFFlOaDL2T9/hero-image.fill.size_1248x702.v1763073914.jpg" class="w-full h-full object-cover">
                <div class="key-overlay absolute inset-0 flex items-center justify-center bg-black/40">
                    <span class="material-icons text-[#f2d00d] text-4xl animate-bounce">vpn_key</span>
                </div>
            </div>
            <span class="mt-4 text-[#f2d00d] font-bold">إنجازات VR</span>
        </div>

        <div class="node node-down relative z-10 flex flex-col items-center group">
            <div class="w-28 h-28 md:w-36 md:h-36 rotate-45 border-4 border-[#f2d00d] overflow-hidden glow-node bg-black relative" onclick="collectKey(1, this)">
                <div class="-rotate-45 w-full h-full">
                    <img src="https://almottawer.com/wp-content/uploads/2024/11/%D8%A7%D9%84%D8%AA%D8%B5%D9%85%D9%8A%D9%85-%D8%A7%D9%84%D8%A7%D9%86%D8%B4%D8%A7%D8%A6%D9%8A-570x380.png" class="w-full h-full object-cover scale-150">
                    <div class="key-overlay absolute inset-0 flex items-center justify-center bg-black/40">
                        <span class="material-icons text-[#f2d00d] text-4xl animate-bounce">vpn_key</span>
                    </div>
                </div>
            </div>
            <span class="mt-8 text-[#f2d00d] font-bold">تصميم هندسي</span>
        </div>

        <div class="node node-up relative z-10 flex flex-col items-center group">
            <div class="w-28 h-28 md:w-36 md:h-36 rounded-2xl border-4 border-[#f2d00d] overflow-hidden glow-node bg-black relative" onclick="collectKey(2, this)">
                <img src="https://storage.googleapis.com/bucket-two-leobotics/product/robot-compagnie-loona-intelligent-keyi-robotics-0.webp" class="w-full h-full object-cover">
                <div class="key-overlay absolute inset-0 flex items-center justify-center bg-black/40">
                    <span class="material-icons text-[#f2d00d] text-4xl animate-bounce">vpn_key</span>
                </div>
            </div>
            <span class="mt-4 text-[#f2d00d] font-bold">المنهج الوصفي</span>
        </div>

        <div class="node node-down relative z-10 flex flex-col items-center group">
            <div class="w-28 h-28 md:w-36 md:h-36 rounded-full border-4 border-[#f2d00d] overflow-hidden glow-node bg-black relative" onclick="collectKey(3, this)">
                <img src="https://png.pngtree.com/png-vector/20230728/ourmid/pngtree-science-lab-vector-png-image_6875920.png" class="w-full h-full object-contain p-2">
                <div class="key-overlay absolute inset-0 flex items-center justify-center bg-black/40">
                    <span class="material-icons text-[#f2d00d] text-4xl animate-bounce">vpn_key</span>
                </div>
            </div>
            <span class="mt-4 text-[#f2d00d] font-bold">المنهج التجريبي</span>
        </div>

        <div id="treasure-chest" class="node relative z-10 flex flex-col items-center">
            <div class="w-32 h-24 md:w-44 md:h-32 bg-[#3a2a10] border-t-8 border-[#f2d00d] rounded-t-2xl shadow-2xl flex items-center justify-center relative overflow-hidden">
                <span id="lock-icon" class="material-icons text-[#f2d00d] text-5xl">lock</span>
            </div>
            <span class="mt-4 text-[#f2d00d] font-bold tracking-widest uppercase">صندوق الكنز</span>
        </div>
    </div>
    <div id="final-modal" class="fixed inset-0 z-[300] flex items-center justify-center bg-black/90 opacity-0 pointer-events-none transition-all duration-1000">
    <div class="text-center p-10 border-2 border-[#f2d00d] bg-[#221f10] rounded-3xl shadow-[0_0_50px_rgba(242,208,13,0.3)] max-w-2xl mx-4 relative overflow-hidden">
        <div class="absolute -top-10 -right-10 text-[100px] text-[#f2d00d]/5 select-none rotate-12">
            <span class="material-icons text-[150px]">auto_awesome</span>
        </div>

        <div class="relative z-10">
            <span class="material-icons text-[#f2d00d] text-7xl mb-6">workspace_premium</span>
            
            <h3 class="text-[#f2d00d] text-2xl md:text-3xl font-bold mb-6 leading-relaxed">
                لم تزوروا معرضًا فقط… <br>
                بل دخلتم عقولَ باحثي المستقبل
            </h3>
            
            <div class="h-[1px] w-32 bg-[#f2d00d]/30 mx-auto mb-6"></div>
            
            <p class="text-white text-xl md:text-2xl mb-8 leading-relaxed">
                هنا لا نعرض مشاريع مدرسية، <br>
                هنا نصنع جيلاً يفكّر ويبتكر
            </p>
            
            <p class="text-[#f2d00d] font-bold text-lg tracking-[4px] uppercase border-t border-[#f2d00d]/20 pt-6">
                مدرسة الذخيرة النموذجية للبنين
            </p>
            
            <button onclick="location.reload()" class="mt-8 px-8 py-2 bg-[#f2d00d] text-black font-bold rounded-full hover:scale-110 transition-transform">
                إغلاق
            </button>
        </div>
    </div>
</div>
</main>

<script>
const chestSound = new Audio('https://www.dropbox.com/scl/fi/2b2eg51rubrnxlgn9vdnt/mixkit-game-level-completed-2059.wav?rlkey=wg44pqbadweipmdnd2fv4qa4l&st=uq4vujfp&raw=1');
const keySound = new Audio("https://www.dropbox.com/scl/fi/u0571hgbe4h8td5lqvlb3/mixkit-game-success-alert-2039.wav?rlkey=f46zg1d4xeikapo4bxbogy64e&st=xd52sm7j&raw=1");

let collectedCount = 0;

function collectKey(index, element) {
    if (element.classList.contains('collected')) return;
    element.classList.add('collected');
    const overlay = element.querySelector('.key-overlay');

    const burst = document.createElement("div");
    burst.className = "key-burst";
    element.appendChild(burst);

    const wave = document.createElement("div");
    wave.className = "energy-wave";
    element.appendChild(wave);

    const keyIcon = overlay?.querySelector(".material-icons");
    if (keyIcon) keyIcon.classList.add("key-collected");

    if (collectedCount < 4) {
        keySound.currentTime = 0;
        keySound.play().catch(e => console.log(e));
    }

    setTimeout(() => { if (overlay) overlay.style.opacity = '0'; }, 400);
    element.style.pointerEvents = 'none';
    collectedCount++;
    updateUI();
}

function updateUI() {
    const progress = collectedCount * 25;
    document.getElementById('progress-text').innerText = progress + "%";
    
    movePinOnPath(collectedCount / 5);

    const indicators = document.querySelectorAll('#key-indicators .material-icons');
    if (indicators[collectedCount - 1]) {
        indicators[collectedCount - 1].classList.replace('text-white/10', 'text-[#f2d00d]');
    }

    if (collectedCount === 4) {
        // تأثيرات فتح الصندوق
        document.getElementById('lock-icon').innerText = 'lock_open';
        document.getElementById('treasure-chest').style.transform = 'scale(1.2)';
        document.getElementById('treasure-chest').style.boxShadow = '0 0 50px #f2d00d';
        
        chestSound.play().catch(e => console.log(e));
        
        // تحريك الدبوس للنهاية
        setTimeout(() => movePinOnPath(1), 500);

        // إظهار الرسالة الختامية بتأثير تدريجي بعد 1.5 ثانية
        setTimeout(() => {
            const modal = document.getElementById('final-modal');
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.classList.add('opacity-100', 'pointer-events-auto');
        }, 1500);
    }
}

function movePinOnPath(ratio) {
    const path = document.getElementById('journey-path');
    const pin = document.getElementById('map-pin');
    if (!path || !pin) return;
    const length = path.getTotalLength();
    if (length === 0) return;
    const point = path.getPointAtLength(length * ratio);
    pin.setAttribute('cx', point.x);
    pin.setAttribute('cy', point.y);
}

function drawPath() {
    const path = document.getElementById('journey-path');
    const nodes = document.querySelectorAll('.node');
    const container = document.getElementById('nodes-container');
    const cRect = container.getBoundingClientRect();

    let d = "";
    nodes.forEach((node, i) => {
        const rect = node.getBoundingClientRect();
        const x = (rect.left + rect.width / 2) - cRect.left;
        const y = (rect.top + rect.height / 2) - cRect.top;

        if (i === 0) { d += `M ${x} ${y}`; return; }

        const prevRect = nodes[i - 1].getBoundingClientRect();
        const px = (prevRect.left + prevRect.width / 2) - cRect.left;
        const py = (prevRect.top + prevRect.height / 2) - cRect.top;
        const dx = x - px;
        const dy = y - py;

        if (window.innerWidth > 1024) {
            d += ` C ${px + dx * 0.4} ${py}, ${px + dx * 0.6} ${y}, ${x} ${y}`;
        } else {
            d += ` C ${px} ${py + dy * 0.4}, ${x} ${py + dy * 0.6}, ${x} ${y}`;
        }
    });

    path.setAttribute('d', d);
    movePinOnPath(collectedCount / 5);
}

window.addEventListener('resize', drawPath);
window.addEventListener('load', drawPath);
setTimeout(drawPath, 500);
</script>
</body>
</html>
